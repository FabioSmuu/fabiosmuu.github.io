<div id="fb-root"></div>
<script src="//connect.facebook.net/en_US/all.js"></script>
<script type="text/javascript">
//https://developers.facebook.com/docs/javascript/reference/v7.0
//https://developers.facebook.com/docs/app-events/gamesonfacebook
//https://developers.facebook.com/docs/reference/javascript/FB.AppEvents.LogEvent
//https://developers.facebook.com/docs/games_payments/payments_lite

FB.init({
	appId            : '3257310224319370',
	autoLogAppEvents : true,
	xfbml            : true,
	version          : 'v7.0'
})


FB.getLoginStatus(conectar)

function login() {
	FB.login(conectar, {scope:'email'})
}

function conectar(response) {
	if (response.authResponse) {
		FB.api('/me', function(response) {
			alert('Olá, ' + response.name + '.')
			document.getElementById('gameoff').style.display = 'none'			
			document.getElementById('gameon').style.display = 'block'
			main(response)
		})
	} else {
		alert('Usuario não autenticado')
		document.getElementById('gameoff').style.display = 'block'
		document.getElementById('gameon').style.display = 'none'
	}
}

function buy() {
	var obj = {
		method: 'pay',
		action: 'purchaseitem',
		product: 'YOUR_PRODUCT_URL'
	}

	FB.ui(obj, function(data) {
		console.log(data)
	})
}

//document.getElementById('pay').onclick = function() {buy()}

function comprar() {
	FB.api(
		'/app/products', 
		'get', 
		function(response) {
			console.log(response)
		}
	)
	
	FB.ui(
		{
			method: 'pay',
			action: 'purchaseiap',
			product_id: 'com.fb.friendsmash.coins.10',
			developer_payload: 'this_is_a_test_payload'
		},
		response => (console.log(response))
	)
}

function compartilhar() {
	FB.ui({
		method: 'share',
		href: 'https://developers.facebook.com/docs/'
	}, function(response){
		if (response && !response.error_message) alert('ok')
	})
}

function main() {
	amigos()
}

function amigos() {
	console.log(FB.gamingservices.friendFinder())
}
</script>

<div id="gameoff">
	<input id="login" type="button" value="Logar com Facebook" onclick="login()"/>
</div>

<div id="gameon">
	<input id="comp" type="button" value="Compartilha" onclick="compartilhar()"/>
	<input id="compra" type="button" value="R$ 1,00" onclick="comprar()"/>
	<input id="pay" type="button" value="Comprar" onclick="buy()"/>
    <div class="returndata" id="output"></div>

</div>
